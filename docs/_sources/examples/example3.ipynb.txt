{
 "cells": [
  {
   "attachments": {},
   "cell_type": "markdown",
   "id": "6900b762",
   "metadata": {},
   "source": [
    "# Basic ML example (Ray Workflow)\n",
    "\n",
    "Here, we use different backend for Basic ML example. \n",
    "\n",
    "## The workflow"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "c843a80a",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2023-05-10 20:36:23,114\tINFO worker.py:1538 -- Started a local Ray instance.\n"
     ]
    }
   ],
   "source": [
    "# Here, we reimplement sklearn example as Function Fuse workflow https://scikit-learn.org/stable/auto_examples/linear_model/plot_sparse_logistic_regression_mnist.html#sphx-glr-auto-examples-linear-model-plot-sparse-logistic-regression-mnist-py\n",
    "\n",
    "from functionfuse import workflow\n",
    "from functionfuse.backends.builtin.rayback import RayWorkflow\n",
    "from functionfuse.storage import storage_factory\n",
    "\n",
    "import os\n",
    "\n",
    "\n",
    "# Frontend\n",
    "\n",
    "@workflow\n",
    "def openml_dataset():\n",
    "    from sklearn.datasets import fetch_openml\n",
    "    from sklearn.utils import check_random_state\n",
    "\n",
    "    X, y = fetch_openml(\"mnist_784\", version=1, return_X_y=True, as_frame=False, parser=\"pandas\")\n",
    "    random_state = check_random_state(0)\n",
    "    permutation = random_state.permutation(X.shape[0])\n",
    "    X = X[permutation]\n",
    "    y = y[permutation]\n",
    "    X = X.reshape((X.shape[0], -1))\n",
    "    return X, y\n",
    "\n",
    "\n",
    "@workflow\n",
    "def train_test_split(X, y, train_samples, test_size):\n",
    "    from sklearn.model_selection import train_test_split\n",
    "\n",
    "    X_train, X_test, y_train, y_test = train_test_split(\n",
    "        X, y, train_size=train_samples, test_size=test_size\n",
    "    )\n",
    "    return {\"X_train\": X_train, \"X_test\": X_test, \"y_train\": y_train, \"y_test\": y_test}\n",
    "\n",
    "@workflow\n",
    "def train_model(X, y):\n",
    "    from sklearn.preprocessing import StandardScaler\n",
    "    from sklearn.pipeline import make_pipeline\n",
    "    from sklearn.linear_model import LogisticRegression\n",
    "\n",
    "    train_samples = len(X)\n",
    "    clf = make_pipeline(StandardScaler(), LogisticRegression(C=50.0 / train_samples, penalty=\"l1\", solver=\"saga\", tol=0.1))\n",
    "    clf.fit(X, y)\n",
    "    return clf\n",
    "\n",
    "\n",
    "dataset = openml_dataset().set_name(\"dataset\")\n",
    "X, y = dataset[0], dataset[1]\n",
    "dataset_split = train_test_split(X, y, train_samples = 5000, test_size = 10000).set_name(\"dataset_split\")\n",
    "model = train_model(dataset_split[\"X_train\"], dataset_split[\"y_train\"]).set_name(\"model\")\n",
    "\n",
    "\n",
    "# Ray Backend\n",
    "\n",
    "ray_init_args = {\n",
    "    \"resources\": {\"_disk\": 1.0, \"_model\": 1}\n",
    "}\n",
    "\n",
    "ray_storage_remote_args = {\n",
    "    \"resources\": {\"_disk\": 0.001}\n",
    "}\n",
    "\n",
    "ray_workflow = RayWorkflow(dataset, workflow_name=\"classifier\", ray_init_args=ray_init_args)\n",
    "\n",
    "# Ray init is called in the RayWorkflow constructor!!! Storage should be created AFTER RayWorkflow is created. \n",
    "storage_path = os.path.join(os.getcwd(), \"storage\")\n",
    "opt = {\n",
    "    \"kind\": \"ray\",\n",
    "    \"options\": {\n",
    "        \"remoteArgs\": ray_storage_remote_args,\n",
    "        \"path\": storage_path,\n",
    "    }\n",
    "}\n",
    "\n",
    "storage = storage_factory(opt)\n",
    "ray_workflow.set_storage(storage)\n",
    "ray_workflow.query(pattern=\"^model$\").set_remote_args({\"num_cpus\": 1, \"resources\": {\"_model\": 1}})\n",
    "\n",
    "_ = ray_workflow.run()"
   ]
  },
  {
   "attachments": {},
   "cell_type": "markdown",
   "id": "f2d7826a",
   "metadata": {},
   "source": [
    "## Model Prediction\n",
    "\n",
    "The code above is designed to train models and save the workflow data in the storage. Typically this code should be placed in a separate Python module. I placed the workflow code in the Jupyter Notebook for demonstration purposes only. Final model analysis and data visualization are performed from the stored data in the Jupyter Notebook as shown below."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "225a0031",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2023-05-10 20:36:34,109\tINFO worker.py:1538 -- Started a local Ray instance.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "All graph node names: \n",
      "['dataset', 'dataset_split', 'model']\n"
     ]
    }
   ],
   "source": [
    "import pprint, os\n",
    "from functionfuse.storage import storage_factory\n",
    "\n",
    "the_workflow_name = \"classifier\"\n",
    "\n",
    "\n",
    "ray_init_args = {\n",
    "    \"resources\": {\"_disk\": 1}\n",
    "}\n",
    "\n",
    "remote_args = {\n",
    "    \"resources\": {\"_disk\": 0.001}\n",
    "}\n",
    "\n",
    "storage_path = os.path.join(os.getcwd(), \"storage\")\n",
    "opt = {\n",
    "    \"kind\": \"ray\",\n",
    "    \"options\": {\n",
    "        \"rayInitArgs\": ray_init_args,\n",
    "        \"remoteArgs\": remote_args,\n",
    "        \"path\": storage_path,\n",
    "    }\n",
    "}\n",
    "\n",
    "storage = storage_factory(opt)\n",
    "all_tasks = storage.list_tasks(workflow_name=the_workflow_name, pattern=\"*\")\n",
    "\n",
    "pp = pprint.PrettyPrinter(width=141, compact=True)\n",
    "print(\"All graph node names: \")\n",
    "pp.pprint(all_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "5e8dcb15",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Sparsity with L1 penalty: 81.11%\n",
      "Test score with L1 penalty: 0.8323\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "Text(0.5, 0.98, 'Classification vector for...')"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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qaSlde4VfYw/2DAGkUiMPySaqzHI+INNvOOv3ckHAAAAABwNCs4BAAAAOEHyAQAAAMAJkg8AAAAATpB8AAAAAHCC5AMAAACAEyQfAAAAAJwg+QAAAADgBMkHAAAAACdIPmL4fD55/vnnE90NdFOMPyQS4w+JxhhEIjH+3OhWyUdVVZVcf/31MmjQIAmFQtK3b1+ZMWOG/P3vf09010Tk82Xpb7vtNiktLZXMzEw588wz5eOPP050t9BBkn38Pfvss3LOOedIUVGR+Hw+WbFiRaK7hA6UzOOvpaVFvvOd78ioUaMkOztbSktL5corr5TKyspEdw0dKJnHoIjIbbfdJsOHD5fs7GwpKCiQs88+W957771EdwsdJNnH38G++c1vis/nk1/+8peJ7kqnSE90B1ypqKiQ0047TfLz8+Xuu++W0aNHS0tLi7z++usyb948WbNmTaK7KHfffbfce++9snDhQhk2bJjccccdMmXKFFm7dq2Ew+FEdw/HIBXGX11dnZx22mnyla98Ra655ppEdwcdKNnHX319vSxbtkx++MMfypgxY2Tv3r1yww03yAUXXCAffPBBQvuGjpHsY1BEZNiwYfLf//3fMmjQIGloaJD77rtPpk6dKhs2bJDi4uJEdw/HIBXG3wHPP/+8vPfee1JaWprornQe001MmzbNlJWVmdraWnXb3r172/4vIua5555r27755pvN0KFDTWZmphk4cKD5wQ9+YJqbm9tuX7FihTnzzDNNTk6OCYfDZty4cWbp0qXGGGMqKirM+eefb/Lz801WVpYZOXKkeeWVV6z9i0ajplevXuZnP/tZW6yxsdHk5eWZX//618d49Ei0ZB9/BysvLzciYpYvX97u40VySaXxd8D7779vRMRs2rTp6A8YSScVx2B1dbUREfO3v/3t6A8YSSVVxt+WLVtMWVmZWbVqlenfv7+57777jum4k1W3+OVjz5498tprr8lPfvITyc7OVrfn5+cf8r7hcFgWLlwopaWlsnLlSrnmmmskHA7LzTffLCIil19+uYwdO1Yefvhh8fv9smLFCgkEAiIiMm/ePGlubpYlS5ZIdna2rF69WnJycqyPU15eLlVVVTJ16tS2WCgUkkmTJsnbb78t3/zmN4/hGUAipcL4Q9eVquOvurpafD7fYfuH1JCKY7C5uVl++9vfSl5enowZM+boDxpJI1XGXzQalSuuuEJuuukmOf7444/toJNdorMfF9577z0jIubZZ589YluJyXpj3X333eakk05q2w6Hw2bhwoXWtqNGjTK33XZbXH186623jIiYrVu3euLXXHONmTp1alz7QHJKhfF3MH756FpSbfwZY0xDQ4M56aSTzOWXX96u+yO5pNIYfOmll0x2drbx+XymtLTUvP/++0d1fySfVBl/P/3pT82UKVNMNBo1xpgu/ctHtyg4N8aIyOezGBytP/3pT3L66adLr169JCcnR374wx/K5s2b227/3//7f8vcuXPl7LPPlp/97GeycePGttu+9a1vyR133CGnnXaaLFiwQD766KMjPl5sH40x7eo3kkcqjT90Pak2/lpaWmTmzJkSjUbloYceOuo+I/mk0hicPHmyrFixQt5++20599xz5atf/ars2LHjqPuN5JEK4+/f//633H///bJw4cJu8Z2vWyQfQ4cOFZ/PJ5988slR3e/dd9+VmTNnyrRp0+Tll1+W5cuXy/e//31pbm5ua3PbbbfJxx9/LNOnT5dFixbJyJEj5bnnnhMRkblz58qnn34qV1xxhaxcuVJOPvlkefDBB62P1atXLxH5fDaGg+3YsUN69ux5VP1GckmF8YeuK5XGX0tLi3z1q1+V8vJyeeONNyQ3N/foDxhJJ5XGYHZ2tgwZMkTGjx8vjz76qKSnp8ujjz569AeNpJEK4++f//yn7NixQ/r16yfp6emSnp4umzZtkhtvvFEGDBjQ7mNPWon82cWlc88996iLje655x4zaNAgT9s5c+aYvLy8Qz7OzJkzzYwZM6y33XLLLWbUqFHW2w4UnN91111tsaamJgrOu4hkH38H47KrricVxl9zc7O56KKLzPHHH2927Nhx6INBSkqFMWgzePBgs2DBgqO6D5JPso+/Xbt2mZUrV3r+lZaWmu985ztmzZo1hz+4FNQtfvkQEXnooYckEonIKaecIn/+859l/fr18sknn8gDDzwgEyZMsN5nyJAhsnnzZnn66adl48aN8sADD7RltCIiDQ0NMn/+fFm8eLFs2rRJ3nrrLVm6dKmMGDFCRERuuOEGef3116W8vFyWLVsmixYtarstls/nkxtuuEF++tOfynPPPSerVq2S2bNnS1ZWllx22WUd/4TAqWQffyKfF+WtWLFCVq9eLSIia9eulRUrVqhf45B6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YsQIERG54YYb5PXXX5fy8nJZtmyZLFq0qO22WLW1tfLtb39b3nnnHamoqJDFixfLjBkzpKioSC6++OKOf0LgVLKPPxGRm266Sf74xz/KI488Ihs2bJD//u//lpdeekmuu+66jn0y4FwqjD8Rkf3798szzzzT9YorkfRjMDc3VyZNmiQ33XSTLF68WMrLy2XhwoXy5JNP8hncBST7+BMReeaZZ2Tx4sXy6aefygsvvCBTpkyRiy66SKZOndqxT0YySHT241JlZaWZN2+e6d+/vwkGg6asrMxccMEF5s0332xrIzHX+910002msLDQ5OTkmEsvvdTcd999bVlvU1OTmTlzpunbt68JBoOmtLTUzJ8/v61Icv78+Wbw4MFt1wheccUVZteuXda+1dfXm6lTp5ri4mITCARMv379zKxZs8zmzZs76+mAY8k8/g549NFHzZAhQ0xGRoYZM2aMef755zv6aUCCpML4+81vfmMyMzPNvn37OvrwkQSSfQxu27bNzJ4925SWlpqMjAxz3HHHmV/84hcmGo12xtMBx5J9/N1///2mT58+bd8Bf/CDH5impqbOeCoSzmeMMQnNfgAAAAB0C93msisAAAAAiUXyAQAAAMAJkg8AAAAATpB8AAAAAHCC5AMAAACAEyQfAAAAAJwg+QAAAADgBMkHAAAAACdIPgAAAAA4QfIBAAAAwAmSDwAAAABO/F8o9OaLbL5+ZwAAAABJRU5ErkJggg==",
      "text/plain": [
       "<Figure size 1000x500 with 10 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "clf = storage.read_task(workflow_name=the_workflow_name, task_name=\"model\")\n",
    "dataset_split = storage.read_task(workflow_name=the_workflow_name,  task_name=\"dataset_split\")\n",
    "X_test, y_test = dataset_split[\"X_test\"], dataset_split[\"y_test\"]\n",
    "\n",
    "lr = clf.named_steps[\"logisticregression\"]\n",
    "\n",
    "sparsity = np.mean(lr.coef_ == 0) * 100\n",
    "score = clf.score(X_test, y_test)\n",
    "# print('Best C % .4f' % clf.C_)\n",
    "print(\"Sparsity with L1 penalty: %.2f%%\" % sparsity)\n",
    "print(\"Test score with L1 penalty: %.4f\" % score)\n",
    " \n",
    "\n",
    "\n",
    "coef = lr.coef_.copy()\n",
    "plt.figure(figsize=(10, 5))\n",
    "scale = np.abs(coef).max()\n",
    "for i in range(10):\n",
    "    l1_plot = plt.subplot(2, 5, i + 1)\n",
    "    l1_plot.imshow(\n",
    "        coef[i].reshape(28, 28),\n",
    "        interpolation=\"nearest\",\n",
    "        cmap=plt.cm.RdBu,\n",
    "        vmin=-scale,\n",
    "        vmax=scale,\n",
    "    )\n",
    "    l1_plot.set_xticks(())\n",
    "    l1_plot.set_yticks(())\n",
    "    l1_plot.set_xlabel(\"Class %i\" % i)\n",
    "plt.suptitle(\"Classification vector for...\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.15"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
